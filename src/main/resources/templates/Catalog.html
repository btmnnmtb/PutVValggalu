<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/site.css}">
    <title>–ö–∞—Ç–∞–ª–æ–≥ –∫–æ—Å–º–µ—Ç–∏–∫–∏</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding-top: 80px;
        }

        .product-rating { margin-top:.5rem; font-weight:600; color:#e91e63; }

        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; }

        h1 { text-align: center; margin-bottom: 2rem; color: #333; font-size: 2.5rem; }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .product-card.pending { opacity: .7; filter: grayscale(.3); cursor: not-allowed; }
        .product-card.pending:hover { transform:none; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }

        .pending-overlay {
            position:absolute; inset:0; background: rgba(0,0,0,.05); z-index:2; border-radius:15px; pointer-events:none;
        }

        .pending-badge {
            position:absolute; top:15px; right:15px; background: linear-gradient(135deg, #ff9800, #f57c00);
            color:#fff; padding:8px 12px; border-radius:20px; font-size:.8rem; font-weight:600; z-index:3;
            box-shadow:0 4px 12px rgba(255,152,0,.3); animation: pulse 2s infinite;
        }

        @keyframes pulse { 0%{transform:scale(1)} 50%{transform:scale(1.05)} 100%{transform:scale(1)} }

        .pending-message {
            position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
            background: rgba(255,255,255,.95); padding:15px 25px; border-radius:10px; font-weight:600;
            color:#ff9800; text-align:center; z-index:3; box-shadow:0 5px 15px rgba(0,0,0,.1);
            backdrop-filter: blur(5px); border:2px solid #ff9800;
        }

        .product-image { width:100%; height:250px; object-fit:cover; border-bottom:1px solid #eee; }

        .product-info { padding: 1.5rem; position: relative; }

        .product-name { font-size:1.3rem; font-weight:700; margin-bottom:.5rem; color:#333; }
        .product-brand { color:#666; font-size:.9rem; margin-bottom:.5rem; }
        .product-type { color:#888; font-size:.8rem; margin-bottom:1rem; }

        .product-description {
            color:#555; font-size:.9rem; margin-bottom:1rem; line-height:1.4;
            display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden;
        }

        .product-details { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem; font-size:.8rem; color:#666; }
        .product-certificate { background:#e91e63; color:#fff; padding:.2rem .5rem; border-radius:10px; font-size:.7rem; }

        .product-price-section { display:flex; justify-content:space-between; align-items:center; margin-top:1rem; padding-top:1rem; border-top:1px solid #eee; }
        .product-price { font-size:1.5rem; font-weight:700; color:#e91e63; }
        .product-quantity { color:#666; font-size:.9rem; }

        .product-status { display:inline-block; padding:.3rem .8rem; border-radius:15px; font-size:.8rem; font-weight:700; }
        .status-in-stock { background:#e8f5e8; color:#2e7d32; }
        .status-low-stock { background:#fff3e0; color:#ef6c00; }
        .status-out-of-stock { background:#ffebee; color:#c62828; }
        .status-pending { background:#fff3e0; color:#ff9800; border:1px solid #ff9800; }

        .filters {
            background:#fff; padding:1.5rem; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,.1); margin-bottom:2rem;
        }

        .search-box { width:100%; padding:.8rem; border:1px solid #ddd; border-radius:8px; font-size:1rem; margin-bottom:1rem; }

        .filter-options { display:flex; gap:1rem; flex-wrap:wrap; }
        .filter-select { padding:.5rem; border:1px solid #ddd; border-radius:5px; background:#fff; }

        @media (max-width: 768px) {
            .products-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap:1rem; }
            .container { padding:1rem; }
            body { padding-top:70px; }
            .pending-message { padding:10px 15px; font-size:.9rem; }
            .pending-badge { padding:6px 10px; font-size:.7rem; }
        }

        .placeholder-image {
            width:100%; height:250px; background:linear-gradient(45deg,#f0f0f0,#e0e0e0);
            display:flex; align-items:center; justify-content:center; color:#999; font-size:.9rem;
        }

        /* header */


        .product-actions { margin-top:1rem; }
        .cart-btn {
            width:100%; padding:12px 0; border:none;
            background: linear-gradient(135deg,#e91e63,#d81b60); color:#fff; border-radius:8px; font-size:1rem; font-weight:600;
            cursor:pointer; transition: all .3s ease; box-shadow:0 4px 15px rgba(233,30,99,.3);
        }
        .cart-btn:hover:not(:disabled) { background: linear-gradient(135deg,#d81b60,#c2185b); transform: translateY(-2px); box-shadow:0 6px 20px rgba(233,30,99,.4); }
        .cart-btn:disabled { background:#ccc; cursor:not-allowed; transform:none; box-shadow:0 2px 8px rgba(0,0,0,.1); }
        .cart-btn-content { display:flex; align-items:center; justify-content:center; gap:8px; }
        .cart-icon { font-size:1.2rem; }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
        .auth-message {
            margin-top: 1rem;
            padding: 1rem;
            background: #fff5f8;
            border: 1px dashed #e91e63;
            border-radius: 10px;
            text-align: center;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        .auth-link {
            color: #e91e63;
            font-weight: 600;
            text-decoration: none;
            transition: color 0.3s;
        }
        .auth-link:hover {
            color: #c2185b;
            text-decoration: underline;
        }

        /* –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ */
        .comments { margin-top:1rem; border-top:1px solid #eee; padding-top:1rem; }
        .comments summary { cursor:pointer; font-weight:600; margin-bottom:.5rem; list-style:none; }
        .comment-list { display:flex; flex-direction:column; gap:.75rem; margin-top:.5rem; }
        .comment-item { background:#fafafa; border:1px solid #eee; border-radius:10px; padding:.75rem .9rem; position:relative; }
        .comment-header { display:flex; align-items:center; gap:.5rem; font-size:.9rem; color:#666; margin-bottom:.25rem; }
        .comment-author { font-weight:600; color:#333; }
        .comment-date { margin-left:auto; font-size:.8rem; color:#999; white-space:nowrap; }
        .comment-text { color:#333; line-height:1.35; white-space:pre-wrap; }
        .comment-rating { font-size:.85rem; color:#e91e63; font-weight:600; }
        .comment-actions { position:absolute; top:.5rem; right:.5rem; z-index:2; }
        .delete-btn { background:transparent; border:none; font-size:1.1rem; line-height:1; cursor:pointer; color:#c62828; padding:2px 6px; border-radius:6px; }
        .delete-btn:hover { background:#ffebee; }

        .comment-form { margin-top:1rem; display:grid; grid-template-columns:1fr 120px auto; gap:.5rem; }
        .comment-textarea { grid-column:1/span 1; width:100%; min-height:120px; max-height:40vh; resize:vertical; padding:.75rem .9rem; border:1px solid #ddd; border-radius:10px; font-size:1rem; line-height:1.35; }
        .comment-rating-select { grid-column:2/span 1; padding:.5rem; border:1px solid #ddd; border-radius:8px; }
        .comment-submit { grid-column:3/span 1; padding:.6rem 1rem; border:none; border-radius:8px; background: linear-gradient(135deg,#e91e63,#d81b60); color:#fff; font-weight:600; cursor:pointer; box-shadow:0 4px 12px rgba(233,30,99,.25); }
        .comment-submit:hover { background: linear-gradient(135deg,#d81b60,#c2185b); }

        @media (max-width:768px){
            .comment-form { grid-template-columns:1fr; }
            .comment-rating-select, .comment-submit { grid-column:1 / -1; }
        }
    </style>
</head>
<body>

<div th:replace="~{fragments :: headerFragment(${role}, ${username})}"></div>

<div class="container">
    <h1>–ö–∞—Ç–∞–ª–æ–≥ –∫–æ—Å–º–µ—Ç–∏–∫–∏</h1>

    <div class="filters">
        <input type="text" class="search-box" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." id="searchInput">
        <div class="filter-options">
            <select class="filter-select" id="brandFilter">
                <option value="">–í—Å–µ –±—Ä–µ–Ω–¥—ã</option>
                <option th:each="brand : ${brands}"
                        th:value="${brand.brandName}"
                        th:text="${brand.brandName}"></option>
            </select>
            <select class="filter-select" id="typeFilter">
                <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                <option th:each="type : ${types}"
                        th:value="${type.cosmeticTypeName}"
                        th:text="${type.cosmeticTypeName}"></option>
            </select>
            <select class="filter-select" id="priceFilter">
                <option value="">–õ—é–±–∞—è —Ü–µ–Ω–∞</option>
                <option value="0-1000">–î–æ 1000‚ÇΩ</option>
                <option value="1000-3000">1000-3000‚ÇΩ</option>
                <option value="3000-5000">3000-5000‚ÇΩ</option>
                <option value="5000-10000">5000-10000‚ÇΩ</option>
            </select>
        </div>
    </div>

    <div class="products-grid" id="productsGrid">

        <div th:each="item : ${items}"
             th:with="isBlocked=${#strings.equalsIgnoreCase(item.statusName,'–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–∏–µ')} or ${#strings.equalsIgnoreCase(item.statusName,'–û—Ç–∫–∞–∑(–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å)')}"
             class="product-card"
             th:data-brand="${item.brandName}"
             th:data-type="${item.cosmeticTypeName}"
             th:data-price="${item.price}"
             th:classappend="${isBlocked} ? ' pending' : ''">

            <div th:if="${isBlocked}" class="pending-badge">‚è≥ –ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</div>
            <div th:if="${isBlocked}" class="pending-overlay"></div>
            <div th:if="${isBlocked}" class="pending-message">üïí –°–∫–æ—Ä–æ –≤ –ø—Ä–æ–¥–∞–∂–µ</div>

            <div class="product-image-container">
                <th:block th:if="${item.imagePath != null and item.imagePath != ''}">
                    <img th:src="${item.imagePath}"
                         th:alt="${item.itemName}"
                         class="product-image"
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                </th:block>
                <div class="placeholder-image"
                     th:style="${item.imagePath == null or item.imagePath == ''} ? 'display:flex' : 'display:none'">
                    üß¥ –ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                </div>
            </div>

            <div class="product-info">
                <div class="product-name" th:text="${item.itemName}">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</div>
                <div class="product-brand" th:text="${item.brandName}">–ë—Ä–µ–Ω–¥</div>
                <div class="product-type" th:text="${item.cosmeticTypeName}">–¢–∏–ø –∫–æ—Å–º–µ—Ç–∏–∫–∏</div>

                <div class="product-description"
                     th:text="${item.description}">
                    –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
                </div>


                <div class="product-details">
                    <span th:text="${item.manufacturerName}">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</span>
                    <span class="product-certificate" th:text="${item.certificateName}">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</span>
                </div>

                <div class="product-price-section">
                    <div class="product-price" th:text="'‚ÇΩ' + ${#numbers.formatDecimal(item.price, 1, 2)}">0.00</div>
                    <div class="product-quantity" th:text="'–û—Å—Ç–∞—Ç–æ–∫: ' + ${item.quantity}">0</div>
                </div>

                <div th:classappend="'product-status ' + (${isBlocked} ? 'status-pending' :
                     (${item.quantity} > 10 ? 'status-in-stock' :
                     (${item.quantity} > 0 ? 'status-low-stock' : 'status-out-of-stock')))"
                     th:text="${isBlocked} ? '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏' :
                        (${item.quantity} > 10 ? '–í –Ω–∞–ª–∏—á–∏–∏' :
                        (${item.quantity} > 0 ? '–ú–∞–ª–æ –≤ –Ω–∞–ª–∏—á–∏–∏' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'))">
                    –°—Ç–∞—Ç—É—Å
                </div>

                <!-- === –î–ï–ô–°–¢–í–ò–Ø: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–æ–∫ === -->
                <div class="product-actions"
                     th:if="${!(role != null and #strings.equalsIgnoreCase(role, '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'))}">

                    <div sec:authorize="isAnonymous()" class="auth-message">
                        –ß—Ç–æ–±—ã –ø–æ–∫—É–ø–∞—Ç—å –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ ‚Äî
                        <a th:href="@{/login}" class="auth-link">–≤–æ–π–¥–∏—Ç–µ</a>
                        –∏–ª–∏

                    </div>


                    <div sec:authorize="isAuthenticated()">
                        <form th:action="@{/cart/add/{cosmeticItemId}(cosmeticItemId=${item.cosmeticItemId})}" method="post">
                            <input type="hidden" name="quantity" value="1">
                            <button type="submit"
                                    class="cart-btn"
                                    th:disabled="${item.quantity == 0 or item.statusName == '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–∏–µ' or item.statusName == '–û—Ç–∫–∞–∑(–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å)'}">
                                <div class="cart-btn-content">
                                    <span class="cart-icon">üõí</span>
                                    <span class="cart-text"
                                          th:text="${item.statusName == ''} ? '–°–∫–æ—Ä–æ –≤ –ø—Ä–æ–¥–∞–∂–µ' :
                              (${item.quantity == 0} ? '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' : '–í –∫–æ—Ä–∑–∏–Ω—É')"></span>
                                </div>
                            </button>
                        </form>

                        <th:block th:with="inFav=${favouriteIds != null and favouriteIds.contains(item.cosmeticItemId)}">
                            <form th:action="@{/favourites/{id}/toggle(id=${item.cosmeticItemId})}" method="post">
                                <input type="hidden" name="redirect" value="/Catalog"/>
                                <button type="submit" class="cart-btn" style="margin-top:.5rem"
                                        th:disabled="${item.statusName == '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–∏–µ' or item.statusName == '–û—Ç–∫–∞–∑(–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å)'}"
                                        th:text="${inFav} ? '‚úì –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º' : '‚ù§ –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ'"></button>
                            </form>
                        </th:block>
                    </div>

                    <!-- –î–ª—è –≥–æ—Å—Ç–µ–π ‚Äî –≤–º–µ—Å—Ç–æ –∫–Ω–æ–ø–æ–∫ –∫–æ—Ä–æ—Ç–∫–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ -->
                    <div sec:authorize="isAnonymous()"
                         style="margin-top:.5rem; padding:.6rem; border:1px dashed #e91e63; border-radius:8px; background:#fff5f8; text-align:center;">
                        –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É –∏–ª–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ ‚Äî –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å.
                    </div>

                </div>

                <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
                <div class="comments">
                    <details>
                        <summary>
                            üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                            <span th:text="${commentsByItem != null and commentsByItem.containsKey(item.cosmeticItemId)
                                  ? '(' + #lists.size(commentsByItem[item.cosmeticItemId]) + ')'
                                  : '(0)'}">(0)</span>
                        </summary>

                        <div class="product-rating">
                            ‚≠ê <span th:text="${item.rating != null ? #numbers.formatDecimal(item.rating,1,1) : '‚Äî'}">‚Äî</span>
                        </div>

                        <div class="comment-list"
                             th:if="${commentsByItem != null and commentsByItem.containsKey(item.cosmeticItemId)}"
                             th:with="list=${commentsByItem[item.cosmeticItemId]}">
                            <div class="comment-item" th:each="c : ${list}">
                                <div class="comment-header">
                                    <span class="comment-author" th:text="${c.user.login}">user</span>
                                    <span class="comment-rating">‚òÖ <span th:text="${c.rating}">5</span>/5</span>
                                    <span class="comment-date"
                                          th:text="${#temporals.format(c.commentDate, 'dd.MM.yyyy HH:mm')}">01.01.2025 12:00</span>

                                    <form class="comment-actions"
                                          th:if="${(username != null and username == c.user.login)
                                                  or (role != null and #strings.equalsIgnoreCase(role, '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'))}"
                                          th:action="@{/comments/{id}/delete(id=${c.commentId})}"
                                          method="post">
                                        <input type="hidden" name="redirect" value="/Catalog"/>
                                        <button type="submit" class="delete-btn" title="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
                                    </form>
                                </div>

                                <div class="comment-text" th:text="${c.commentText}">–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è‚Ä¶</div>
                            </div>
                        </div>

                        <div class="comment-list" th:if="${commentsByItem == null or !commentsByItem.containsKey(item.cosmeticItemId)}">
                            <div class="comment-item">–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ ‚Äî –±—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>
                        </div>

                        <!-- –§–æ—Ä–º–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è: —Å–∫—Ä—ã—Ç–∞ –¥–ª—è –∞–¥–º–∏–Ω–∞; –¥–ª—è –≥–æ—Å—Ç–µ–π ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è -->
                        <div th:if="${!(role != null and #strings.equalsIgnoreCase(role, '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'))}">
                            <div sec:authorize="isAnonymous()"
                                 style="margin-top:.75rem; padding:.75rem; border:1px dashed #e91e63; border-radius:10px; background:#fff5f8;">
                                –ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π,&nbsp;
                                <a th:href="@{/login}" style="font-weight:600; color:#e91e63;">–≤–æ–π–¥–∏—Ç–µ</a>
                                &nbsp;–∏–ª–∏&nbsp;
                                <a th:href="@{/registration}" style="font-weight:600; color:#e91e63;">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>.
                            </div>

                            <form class="comment-form" sec:authorize="isAuthenticated()"
                                  th:action="@{/comments}" method="post">
                                <input type="hidden" name="cosmeticItemId" th:value="${item.cosmeticItemId}"/>
                                <input type="hidden" name="redirect" value="/Catalog"/>
                                <textarea class="comment-textarea" name="commentText" placeholder="–í–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π‚Ä¶" required></textarea>
                                <select class="comment-rating-select" name="rating" required>
                                    <option value="" disabled selected>–û—Ü–µ–Ω–∫–∞</option>
                                    <option th:each="r : ${#numbers.sequence(1,5)}"
                                            th:value="${r}" th:text="${r + ' ‚òÖ'}"></option>
                                </select>
                                <button class="comment-submit" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                            </form>
                        </div>

                    </details>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('searchInput');
        const brandFilter = document.getElementById('brandFilter');
        const typeFilter = document.getElementById('typeFilter');
        const priceFilter = document.getElementById('priceFilter');
        const productCards = document.querySelectorAll('.product-card');

        function filterProducts() {
            const searchText = (searchInput.value || '').toLowerCase();
            const selectedBrand = brandFilter.value;
            const selectedType = typeFilter.value;
            const selectedPrice = priceFilter.value;

            productCards.forEach(card => {
                const brand = card.getAttribute('data-brand');
                const type = card.getAttribute('data-type');
                const price = parseFloat(card.getAttribute('data-price')) || 0;
                const nameEl = card.querySelector('.product-name');
                const name = nameEl ? nameEl.textContent.toLowerCase() : '';

                const matchesSearch = name.includes(searchText);
                const matchesBrand = !selectedBrand || brand === selectedBrand;
                const matchesType = !selectedType || type === selectedType;
                const matchesPrice = !selectedPrice || checkPriceRange(price, selectedPrice);

                card.style.display = (matchesSearch && matchesBrand && matchesType && matchesPrice) ? 'block' : 'none';
            });
        }

        function checkPriceRange(price, range) {
            const [min, max] = range.split('-').map(Number);
            return price >= min && price <= max;
        }

        searchInput.addEventListener('input', filterProducts);
        brandFilter.addEventListener('change', filterProducts);
        typeFilter.addEventListener('change', filterProducts);
        priceFilter.addEventListener('change', filterProducts);
    });
</script>

</body>
</html>